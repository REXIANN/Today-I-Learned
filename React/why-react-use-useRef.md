# 왜 리액트에서는 useRef 를 사용할까?
## useRef 의 사용 용도
일반적으로 렌더링이 될 때 마다 리액트는 리액트 컴포넌트 함수 본문을 다시 실행한다. 
이 때 컴포넌트 안에 선언된 변수나 멤버 함수들은 모두 한번씩 실행이 된다. 

이러한 작업은 useState 로 선언된 변수가 업데이트 되었을 때에도 동일하게 진행된다. 
왜냐하면 리액트에서 setState 메서드가 실행이 되면 데이터의 변경이 있다고 보고, 가상 DOM 을 다시 그리기 때문이다. 

하지만 특정 상황에서는 값을 그저 기록만 해놓고, 재렌더링은 일어나지 않게 하고 싶을 때가 있다.
그때를 위해 사용할 수 있는 것이 useRef 훅 이다. 

useRef 는 실행하면 하나의 레퍼런스(이하 Ref)를 반환하며, 이 안에는 .current 라는 멤버 변수가 있다.
이 멤버변수 안에 저장되는 값은 선언형이 아닌 명령형처럼 변경할 수 있으며, 값이 변경되더라도 별다른 추가적인 작업이 일어나지 않는다.
다시 말해, Ref.current 가 변경되더라도 가상 DOM 을 다시 만드는 작업은 일어나지 않는다.
이러한 특성 덕분에 타이머의 id 나 네트워크 요청과 같이 렌더링간에 지속되어야 하는 값을 저장하기에 좋다.

위에서 말한 사용법은 Ref 의 첫번째 사용법이다. 

두번째 사용법으로는 하나의 리액트 컴포넌트 또는 html 엘리먼트를 연결하여 해당 엘리먼트에 접근하여 조작이 가능하도록 해준다.
그런데 이 두번째 사용법에서 의문이 있다.

이미 자바스크립트에는 `document.querySelector`나 `document.getElementById`와 같은 엘리먼트 셀렉터가 있는데 왜 굳이 Ref 를 사용하라고 할까?
Ref를 사용하려면 1. useRef 훅을 사용한 변수를 선언해야 하고 2. 해당 변수와 엘리먼트를 연결해야 하며 3. 실제로 사용하는 곳에서 type narrowing 을 사용해서 Ref.current 가 null 이 아님등을 알려주고 사용해야 한다.

왜 기존에 되는 방법이 있는데 다시 리액트만의 훅을 사용하라고 하는지 궁금해 찾아보니 이유는 다음과 같다.
## query selector 대신 useRef 를 사용해야 하는 이유
### 1. 성능 (Performance)
쿼리 셀렉터는 굉장히 크기가 큰 DOM 을 순회하며 해당 선택자를 찾을 때 느려질 수 있다.
Ref 를 사용하면 전체 DOM 을 순회하지 않고 특정 노드에 바로 접근할 수 있어 성능상의 이점을 얻을 수 있다.

### 2. 재사용성 (Reusability)
Ref를 엘리먼트에 연결하는 방법은 하나의 HTML 엘리먼트의 어트리뷰트에 `ref={Ref}` 형태로 연결하여 사용한다.
따라서 하나의 Ref 는 무조건 한 개의 엘리먼트값을 가지며 Ref의 재사용이 용이하다.

하지만 쿼리 셀렉터의 경우 하나 이상의 값을 가질 수도 있으며, 이는 셀렉터를 사용해서 얻은 값들의 조작이 Ref 보다 불편할 수 있다는 단점이 있다.

### 3. 직접 조작 (Direct Manipulation)
Ref를 사용한다면 가상 DOM 이 아닌 실제 DOM 의 직접 조작이 가능하다.
다시 말해 리액트의 재조정 프로세스를 거치지 않고 원하는 엘리먼트에 바로 접근하여 조작이 가능하며,
이는 input 엘리먼트에 포커싱을 주거나 특정 엘리먼트의 위치와 크기를 구하는 등의 작업에서 유용할 수 있다.

### 4. 리렌더링 (Re-rendering)
Ref 를 사용해서 HTML 엘리먼트에 연결한 경우, DOM 에 업데이트가 있으면 해당 Ref 도 같이 업데이트 된다. 

컴포넌트가 다시 렌더링이 되면 Ref는 새로운 DOM 노드를 가리키도록 업데이트 되지만 쿼리 셀렉터는 이전의 노드를 가리키고 있다.
따라서 쿼리 셀렉터로는 최신 DOM 상태를 추적하기가 어렵다.

## .current 는 뭘까?
여러가지 이유로 리액트에서 특정 엘리먼트에 접근하는 경우에는 쿼리 셀렉터보다 useRef 를 사용해야 한다는 점을 알았다.
근데 Ref를 사용하는 경우에는 `Ref.current` 형태로 사용해야 한다. 
어차피 훅을 실행해서 하나의 변수에 할당하는데, 왜 굳이 `current` 라는 멤버 변수를 하나 더 두고 그 안에 값을 저장하는 걸까?
 ```js
import * as React from 'react'

function App() {
  const ref = React.useRef();
  
  React.useEffect(() => {
    if (ref.current != null) {
      // ...
    }
  })
  
  return (
    <div>
      <span ref={ref}>hello world</span>
    </div>
  )
}
```

찾아보니 훅의 반환값을 변수에 할당하지 않고 바로 사용할 수 있다는 것은 사실이다.

하지만 훅의 실행한 결과값이 저장되는 변수의 이름은 사용자가 마음대로 정할 수 있으며, 
그 안에 있는 값이 리액트의 렌더링 프로세스에 영향을 주거나 받지 않는다는 것을 표시할 방법이 따로 존재하지 않는다.

그렇기 때문에 훅의 실행한 결과값을 바로 사용하지 않고 그 안에 `current` 라는 멤버 변수를 따로 하나 두어서 해당 변수는 Ref 값이고, 
그 변수에 현재 담겨있는 값이 무엇인지 알려주기 위해 `current` 라는 네이밍을 가지는 것이다.
